<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Standard statistical analyses &mdash; PyCogent 1.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyCogent 1.9 documentation" href="../index.html" />
    <link rel="up" title="PyCogent Cookbook" href="index.html" />
    <link rel="next" title="Multivariate data analysis" href="multivariate_data_analysis.html" />
    <link rel="prev" title="Evolutionary analysis using likelihood" href="using_likelihood_to_perform_evolutionary_analyses.html" />     
<script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAbW_pA971hrPgosv-Msv7hRQZ4X-jPDmWcshBrz2j7-fJvuUABRTGWmdiw2G89JpgztGlFGG8hDxRAw"></script>\
<script type="text/javascript" src="../_static/google_feed.js"></script>

  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">PyCogent 1.9 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="using_likelihood_to_perform_evolutionary_analyses.html" title="Evolutionary analysis using likelihood"
             accesskey="P">previous</a> |
          <a href="multivariate_data_analysis.html" title="Multivariate data analysis"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="standard-statistical-analyses">
<h1>Standard statistical analyses<a class="headerlink" href="#standard-statistical-analyses" title="Permalink to this headline">¶</a></h1>
<div class="section" id="random-numbers">
<h2>Random Numbers<a class="headerlink" href="#random-numbers" title="Permalink to this headline">¶</a></h2>
<p>Many of the code snippets in this section use random numbers. These can be obtained using functions from Python&#8217;s <code class="docutils literal"><span class="pre">random</span></code> module, or using <code class="docutils literal"><span class="pre">numpy.random</span></code>. To facilitate testing, the examples &#8220;seed&#8221; the random number generator, which ensures the same results each time the code is run.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">157</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="go">224</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">52.7668...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">157</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_integers</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="go">array([-1,  1,  1,  1,  0])</span>
</pre></div>
</div>
<p>For the last example, note that the range includes 0.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([ 42.8217253 ,  49.90008293])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([ 1.26613052,  1.59533412,  0.95612413])</span>
</pre></div>
</div>
</div>
<div class="section" id="summary-statistics">
<h2>Summary statistics<a class="headerlink" href="#summary-statistics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="population-mean-and-median">
<h3>Population mean and median<a class="headerlink" href="#population-mean-and-median" title="Permalink to this headline">¶</a></h3>
<p>PyCogent&#8217;s functions for statistical analysis operate on <code class="docutils literal"><span class="pre">numpy</span></code> arrays</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">157</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">gauss</span><span class="p">(</span><span class="n">mu</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">49.9927...</span>
</pre></div>
</div>
<p>but in some cases they will also accept a simple list of values</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="go">4.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="go">4.66666...</span>
</pre></div>
</div>
<p>The keyword argument <code class="docutils literal"><span class="pre">axis</span></code> controls whether a function operates by rows (<code class="docutils literal"><span class="pre">axis=0</span></code>) or by columns (<code class="docutils literal"><span class="pre">axis=1</span></code>), or on all of the values (<code class="docutils literal"><span class="pre">axis=None</span></code>)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nums</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">50</span><span class="p">]</span> <span class="o">+</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">500</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([[  1,   2,   3,   4,   5,  50],</span>
<span class="go">       [ 10,  20,  30,  40,  50, 500]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([   5.5,   11. ,   16.5,   22. ,   27.5,  275. ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([  10.83333333,  108.33333333])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">59.58333...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([   5.5,   11. ,   16.5,   22. ,   27.5,  275. ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([  3.5,  35. ])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">15.0</span>
</pre></div>
</div>
</div>
<div class="section" id="population-variance-and-standard-deviation">
<h3>Population variance and standard deviation<a class="headerlink" href="#population-variance-and-standard-deviation" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stats</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[  4.05000000e+01   1.62000000e+02   3.64500000e+02   6.48000000e+02</span>
<span class="go">   1.01250000e+03   1.01250000e+05]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stats</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[   6.36396103   12.72792206   19.09188309   25.45584412   31.81980515</span>
<span class="go">  318.19805153]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stats</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[   370.16666667  37016.66666667]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stats</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">[  19.23971587  192.39715868]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stats</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">19586.6287879</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">stats</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="go">139.952237524</span>
</pre></div>
</div>
<p>The variance (and standard deviation) are unbiased</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="go">2.5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mf">1.0</span> <span class="o">*</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">arr</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">2.5</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="distributions">
<h2>Distributions<a class="headerlink" href="#distributions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="binomial">
<h3>Binomial<a class="headerlink" href="#binomial" title="Permalink to this headline">¶</a></h3>
<p>The binomial distribution can be used for calculating the probability of specific frequencies of states occurring in discrete data. The two alternate states are typically referred to as a success or failure. This distribution is used for sign tests.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.distribution</span> <span class="k">as</span> <span class="nn">distr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distr</span><span class="o">.</span><span class="n">binomial_low</span><span class="p">(</span><span class="n">successes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">0.623...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distr</span><span class="o">.</span><span class="n">binomial_high</span><span class="p">(</span><span class="n">successes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">0.376...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distr</span><span class="o">.</span><span class="n">binomial_exact</span><span class="p">(</span><span class="n">successes</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">prob</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="go">0.246...</span>
</pre></div>
</div>
</div>
<div class="section" id="chi-square">
<h3>Chi-square<a class="headerlink" href="#chi-square" title="Permalink to this headline">¶</a></h3>
<p>A convenience function for computing the probability of a chi-square statistic is provided at the <code class="docutils literal"><span class="pre">stats</span></code> top level.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.stats</span> <span class="k">import</span> <span class="n">chisqprob</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chisqprob</span><span class="p">(</span><span class="mf">3.84</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">0.05...</span>
</pre></div>
</div>
<p>which is just a reference to the <code class="docutils literal"><span class="pre">chi_high</span></code> function.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.stats.distribution</span> <span class="k">import</span> <span class="n">chi_high</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi_high</span><span class="p">(</span><span class="mf">3.84</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">0.05...</span>
</pre></div>
</div>
<div class="section" id="getting-the-inverse">
<h4>Getting the inverse<a class="headerlink" href="#getting-the-inverse" title="Permalink to this headline">¶</a></h4>
<p>Given a probability we can determine the corresponding chi-square value for a given degrees-of-freedom.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.stats.distribution</span> <span class="k">import</span> <span class="n">chdtri</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chdtri</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="go">3.84...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chdtri</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="go">5.99...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="normal">
<h3>Normal<a class="headerlink" href="#normal" title="Permalink to this headline">¶</a></h3>
<p>The function <code class="docutils literal"><span class="pre">zprob()</span></code> takes a z-score or standard deviation and computes the fraction of the normal distribution (mean=0, std=1) which lies farther away from the mean than that value.  For example, only about 4.5% of the values are more than 2 standard deviations away from the mean, so that more than 95% of the values are at least that close to the mean.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.distribution</span> <span class="k">as</span> <span class="nn">distr</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%.4f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">distr</span><span class="o">.</span><span class="n">zprob</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="gp">...</span>
<span class="go">0 1.0000</span>
<span class="go">1 0.3173</span>
<span class="go">2 0.0455</span>
<span class="go">3 0.0027</span>
<span class="go">4 0.0001</span>
</pre></div>
</div>
<p>Use the functions <code class="docutils literal"><span class="pre">z_low()</span></code> and <code class="docutils literal"><span class="pre">z_high()</span></code> to compute the normal distribution in a directional fashion.  Here we see that a z-score of 1.65 has a value greater than 95% of the values in the distribution, and similarly a z-score of 1.96 has a value greater than 97.5% of the values in the distribution.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">distr</span><span class="o">.</span><span class="n">z_low</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.95</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">z</span> <span class="o">+=</span> <span class="mf">0.01</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<span class="go">1.6500...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">distr</span><span class="o">.</span><span class="n">z_low</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.975</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">z</span> <span class="o">+=</span> <span class="mf">0.01</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<span class="go">1.9600...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="normalizing-data-as-z-scores">
<h2>Normalizing data (as Z-scores)<a class="headerlink" href="#normalizing-data-as-z-scores" title="Permalink to this headline">¶</a></h2>
<p>The function <code class="docutils literal"><span class="pre">z_test()</span></code> takes a sample of values as the first argument, and named arguments for the population parameters:  <code class="docutils literal"><span class="pre">popmean</span></code> and <code class="docutils literal"><span class="pre">popstddev</span></code> (with default  values of 0 and 1), and returns the z-score and its probability.</p>
<p>In this example, we grab a sample from a population with <code class="docutils literal"><span class="pre">mean=50</span></code> and <code class="docutils literal"><span class="pre">std=3</span></code>, and call <code class="docutils literal"><span class="pre">z_test()</span></code> with the population mean specified as 50 and the <code class="docutils literal"><span class="pre">popstddev</span></code> assuming its default value of 1:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">157</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">49.9...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">round</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">arr</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">3.1...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">z_test</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">popmean</span><span class="o">=</span><span class="mf">50.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">z</span>
<span class="go">-3.08...</span>
</pre></div>
</div>
</div>
<div class="section" id="resampling-based-statistics">
<h2>Resampling based statistics<a class="headerlink" href="#resampling-based-statistics" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-jackknife">
<h3>The Jackknife<a class="headerlink" href="#the-jackknife" title="Permalink to this headline">¶</a></h3>
<p>This is a data resampling based approach to estimating the confidence in measures of location (like the mean). The method is based on omission of one member of a sample and recomputing the statistic of interest. This measures the influence of individual observations on the sample and also the confidence in the statistic.</p>
<p>The <code class="docutils literal"><span class="pre">Jackknife</span></code> class relies on our ability to handle a set of indexes for sub-setting our data and re-computing our statistic. The client code must be able to take a indices and generate a new statistic.</p>
<p>We demo using the jackknife the estimate of mean GC% for an alignment. We first write a factory function to compute the confidence in the mean GC% for an alignment by sampling specific columns.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">CalcGc</span><span class="p">(</span><span class="n">aln</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">calc_gc</span><span class="p">(</span><span class="n">indices</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">new</span> <span class="o">=</span> <span class="n">aln</span><span class="o">.</span><span class="n">takePositions</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">probs</span> <span class="o">=</span> <span class="n">new</span><span class="o">.</span><span class="n">getMotifProbs</span><span class="p">()</span>
<span class="gp">... </span>        <span class="n">gc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="s1">&#39;CG&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="s1">&#39;ACGT&#39;</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">gc</span> <span class="o">/</span> <span class="n">total</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">calc_gc</span>
</pre></div>
</div>
<p>We then create an instance of this factory function with a specific alignment.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent</span> <span class="k">import</span> <span class="n">LoadSeqs</span><span class="p">,</span> <span class="n">DNA</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aln</span> <span class="o">=</span> <span class="n">LoadSeqs</span><span class="p">(</span><span class="s1">&#39;data/test.paml&#39;</span><span class="p">,</span> <span class="n">moltype</span><span class="o">=</span><span class="n">DNA</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calc_gc</span> <span class="o">=</span> <span class="n">CalcGc</span><span class="p">(</span><span class="n">aln</span><span class="p">)</span>
</pre></div>
</div>
<p>We now create a <code class="docutils literal"><span class="pre">Jackknife</span></code> instance, passing it the <code class="docutils literal"><span class="pre">calc_gc</span></code> instance we have just made and obtain the sampling statistics. We specify how many elements we&#8217;re interested in (in this case, the positions in the alignment).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.stats.jackknife</span> <span class="k">import</span> <span class="n">JackknifeStats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">jk</span> <span class="o">=</span> <span class="n">JackknifeStats</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">aln</span><span class="p">),</span> <span class="n">calc_gc</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jk</span><span class="o">.</span><span class="n">SampleStat</span>
<span class="go">0.4766...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jk</span><span class="o">.</span><span class="n">SummaryStats</span>
<span class="go">Summary Statistics</span>
<span class="go">===============================================</span>
<span class="go">Sample Stat    Jackknife Stat    Standard Error</span>
<span class="go">-----------------------------------------------</span>
<span class="go">     0.4767            0.4767            0.0584</span>
<span class="go">-----------------------------------------------</span>
</pre></div>
</div>
<p>We also display the sub-sample statistics.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">jk</span><span class="o">.</span><span class="n">SubSampleStats</span>
<span class="go">Subsample Stats</span>
<span class="go">============</span>
<span class="go"> i    Stat-i</span>
<span class="go">------------</span>
<span class="go"> 0    0.4678</span>
<span class="go"> 1    0.4678</span>
<span class="go"> 2    0.4847</span>
<span class="go"> 3    0.4814...</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You can provide a custom index generation function that omits groups of observations, for instance. This can be assigned to the <code class="docutils literal"><span class="pre">gen_index</span></code> argument of the <code class="docutils literal"><span class="pre">Jackknife</span></code> constructor.</p>
</div>
</div>
</div>
<div class="section" id="permutations">
<h2>Permutations<a class="headerlink" href="#permutations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="random">
<h3>Random<a class="headerlink" href="#random" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="k">import</span> <span class="n">permutation</span> <span class="k">as</span> <span class="n">perm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">153</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">perm</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">[2 1 3 0 4]</span>
<span class="go">[0 3 2 4 1]</span>
<span class="go">[4 0 1 2 3]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="differences-in-means">
<h2>Differences in means<a class="headerlink" href="#differences-in-means" title="Permalink to this headline">¶</a></h2>
<p>Consider a single sample of 50 value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1357</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nums1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Although we don&#8217;t know the population values for the mean and standard deviation for this sample, we can evaluate the probability that the sample could have been drawn from some population with known values, as shown above in Normalizing data (as Z-scores).</p>
<p>If we have a second sample, whose parent population mean and standard deviation are also unknown:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nums2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>Suppose we believe (before we see any data) that the mean of the first population is different than the second but we don&#8217;t know in which direction the change lies, we estimate the standard deviation.  We use the standard error of the mean as an estimate for how close the mean of sample 2 is to the mean of its parent population (and vice-versa).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">mean_nums2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">nums2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sd_nums2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">nums2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se_nums2</span> <span class="o">=</span> <span class="n">sd_nums2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nums2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se_nums2</span>
<span class="go">1.1113...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_nums1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">nums1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_nums1</span>
<span class="go">46.5727...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_nums2</span>
<span class="go">50.3825...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mean_nums1</span> <span class="o">&lt;</span> <span class="n">mean_nums2</span> <span class="o">-</span> <span class="mf">1.96</span> <span class="o">*</span> <span class="n">se_nums2</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="t-tests">
<h2>t-Tests<a class="headerlink" href="#t-tests" title="Permalink to this headline">¶</a></h2>
<p>Small sample sizes can be handled by the use of t-tests.  The function <code class="docutils literal"><span class="pre">t_two_sample()</span></code> is used for two independent samples.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">subsample1</span> <span class="o">=</span> <span class="n">nums1</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">subsample1</span><span class="p">]</span>
<span class="go">[&#39;49.25&#39;, &#39;38.87&#39;, &#39;47.06&#39;, &#39;44.49&#39;, &#39;43.73&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subsample1</span><span class="p">)</span>
<span class="go">44.67901...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subsample2</span> <span class="o">=</span> <span class="n">nums2</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">subsample2</span><span class="p">]</span>
<span class="go">[&#39;51.57&#39;, &#39;40.6&#39;, &#39;49.62&#39;, &#39;46.69&#39;, &#39;59.34&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subsample2</span><span class="p">)</span>
<span class="go">49.56494...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t_two_sample</span><span class="p">(</span><span class="n">subsample1</span><span class="p">,</span><span class="n">subsample2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">-1.3835...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span>
<span class="go">0.20388...</span>
</pre></div>
</div>
<p>The two sample means are not significantly different.</p>
<p>If there is one small sample and we want to ask whether it is unlikely to have come from a population with a known mean, use the function <code class="docutils literal"><span class="pre">t_one_sample()</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="p">[</span><span class="mf">52.6</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">49.8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t_one_sample</span><span class="p">(</span><span class="n">arr</span><span class="p">,</span> <span class="n">popmean</span><span class="o">=</span><span class="mi">48</span><span class="p">,</span> <span class="n">tails</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">3.99681...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span>
<span class="go">0.02863...</span>
</pre></div>
</div>
<p>For related samples (pre- and post-treatment), use the function <code class="docutils literal"><span class="pre">t_paired()</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pre</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">52.6</span><span class="p">,</span> <span class="mf">51.3</span><span class="p">,</span> <span class="mf">49.8</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">post</span> <span class="o">=</span> <span class="p">[</span><span class="mf">62.6</span><span class="p">,</span> <span class="mf">75.0</span><span class="p">,</span> <span class="mf">65.2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t_paired</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">,</span> <span class="n">tails</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span>
<span class="go">-4.10781...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span>
<span class="go">0.02723...</span>
</pre></div>
</div>
</div>
<div class="section" id="sign-test">
<h2>Sign test<a class="headerlink" href="#sign-test" title="Permalink to this headline">¶</a></h2>
<p>This is essentially just a test using the binomial distribution where the probability of success = 0.5.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">import</span> <span class="n">sign_test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sign_test</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="go">0.056...</span>
</pre></div>
</div>
</div>
<div class="section" id="association">
<h2>Association<a class="headerlink" href="#association" title="Permalink to this headline">¶</a></h2>
<p>We create some data for testing for association.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_nums</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_nums</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">error</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_nums</span> <span class="o">=</span> <span class="p">[(</span><span class="n">x</span> <span class="o">*</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_nums</span><span class="p">,</span> <span class="n">error</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_nums</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_nums</span><span class="p">)</span>
</pre></div>
</div>
<p>We then compute Kendall&#8217;s tau and associated probability, which tests the null hypothesis that x and y are not associated.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">import</span> <span class="n">kendall_correlation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tau</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">kendall_correlation</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">tau</span>
<span class="go">0.688...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">prob</span>
<span class="go">0.00468...</span>
</pre></div>
</div>
</div>
<div class="section" id="correlation">
<h2>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h2>
<p>For this example, we generate y-values as one-half the x-value plus a bit of random error</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_array</span> <span class="o">=</span> <span class="n">x_array</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">+</span> <span class="n">error</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_array</span>
<span class="go">array([ 1,  2,  3,  4,  5,  6,  7,  8,  9, 10])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">y_array</span><span class="p">]</span>
<span class="go">[&#39;-0.21&#39;, &#39;1.75&#39;, &#39;1.46&#39;, &#39;2.45&#39;, &#39;3.85&#39;, &#39;3.53&#39;, &#39;4.85&#39;, &#39;4.86&#39;, &#39;5.98&#39;, &#39;3.95&#39;]</span>
</pre></div>
</div>
<p>The function <code class="docutils literal"><span class="pre">correlation()</span></code> returns the Pearson correlation between x and y, as well as its significance</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">correlation</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span>
<span class="go">0.8907...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span>
<span class="go">0.0005...</span>
</pre></div>
</div>
<p>The function <code class="docutils literal"><span class="pre">regress()</span></code> returns the coefficients to the regression line &#8220;y=ax+b&#8221;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span><span class="p">,</span> <span class="n">y_intercept</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">regress</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span>
<span class="go">0.5514...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y_intercept</span>
<span class="go">0.2141...</span>
</pre></div>
</div>
<p>Calculate the R^2 value for the regression of x and y</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">R_squared</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">regress_R2</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">R_squared</span>
<span class="go">0.7934...</span>
</pre></div>
</div>
<p>And finally, the residual error for each point from the linear regression</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">regress_residuals</span><span class="p">(</span><span class="n">x_array</span><span class="p">,</span> <span class="n">y_array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">error</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span>
<span class="go">[&#39;-0.98&#39;, &#39;0.44&#39;, &#39;-0.41&#39;...</span>
</pre></div>
</div>
</div>
<div class="section" id="chi-squared-test">
<h2>Chi-Squared test<a class="headerlink" href="#chi-squared-test" title="Permalink to this headline">¶</a></h2>
<p>Calculus class data (from Grinstead and Snell, Introduction to Probability).  There seems to be a disparity in the number of &#8216;A&#8217; grades awarded when broken down by student gender.  As input to the function <code class="docutils literal"><span class="pre">chi_square_from_Dict2D()</span></code> we need a <code class="docutils literal"><span class="pre">Dict2D</span></code> object containing the observed counts that has been processed by <code class="docutils literal"><span class="pre">calc_contingency_expected()</span></code> to add the expected counts for each element of the table</p>
<p><code class="docutils literal"><span class="pre">Expected</span> <span class="pre">=</span> <span class="pre">row_total</span> <span class="pre">x</span> <span class="pre">column_total</span> <span class="pre">/</span> <span class="pre">overall_total</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.util.dict2d</span> <span class="k">import</span> <span class="n">Dict2D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F_grades</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">63</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">47</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M_grades</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">:</span><span class="mi">56</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="mi">43</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">grades</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;F&#39;</span><span class="p">:</span><span class="n">F_grades</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="n">M_grades</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">Dict2D</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span>
<span class="go">{&#39;M&#39;: {&#39;A&#39;: 56...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OE_data</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">calc_contingency_expected</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OE_data</span>
<span class="go">{&#39;M&#39;: {&#39;A&#39;: [56, 48.686...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span><span class="p">,</span> <span class="n">chi_high</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi_square_from_Dict2D</span><span class="p">(</span><span class="n">OE_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">test</span>
<span class="go">4.12877...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chi_high</span>
<span class="go">0.24789...</span>
</pre></div>
</div>
<p>Nearly 25% of the time we would expect a Chi-squared statistic as extreme as this one or more (with df = 3), so the result is not significant.</p>
<p>Goodness-of-fit calculation with the same data</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g_val</span><span class="p">,</span> <span class="n">prob</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">G_fit_from_Dict2D</span><span class="p">(</span><span class="n">OE_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g_val</span>
<span class="go">4.1337592429166437</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prob</span>
<span class="go">0.76424854978813872</span>
</pre></div>
</div>
</div>
<div class="section" id="scatterplots">
<h2>Scatterplots<a class="headerlink" href="#scatterplots" title="Permalink to this headline">¶</a></h2>
<p>In this example, we generate the error as above, but separately from the x-value, and subsequently transform using matrix multiplication</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">random</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">cogent.maths.stats.test</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_nums</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_nums</span><span class="p">))]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">error</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="o">*</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">error</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_nums</span> <span class="o">+</span> <span class="n">error</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_nums</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span>
<span class="go">array([[  1.        ,   2.        ,   3.        ,   4.        ,</span>
<span class="go">          5.        ,   6.        ,   7.        ,   8.        ,</span>
<span class="go">          9.        ,  10.        ],</span>
<span class="go">       [  0.38851274,  -1.02788699,  -1.02612288,  -1.27400424,</span>
<span class="go">          0.27858626,   0.34583791,  -0.22073988,  -0.3377444 ,</span>
<span class="go">         -1.1010354 ,   0.19531953]])</span>
</pre></div>
</div>
<p>We can use a transformation matrix to rotate the points</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="k">import</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">z</span><span class="p">,</span><span class="o">-</span><span class="n">z</span><span class="p">],[</span><span class="n">z</span><span class="p">,</span><span class="n">z</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rotated_x</span><span class="p">,</span> <span class="n">rotated_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">arr</span><span class="p">)</span>
</pre></div>
</div>
<p>The plotting code uses <a class="reference external" href="http://matplotlib.sourceforge.net/">matplotlib</a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rotated_x</span><span class="p">,</span><span class="n">rotated_y</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="go">(-2.0, 12.0, -2.0, 8.0)</span>
</pre></div>
</div>
<p>Plot the least squares regression lines too</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span><span class="p">,</span> <span class="n">y_intercept</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">regress</span><span class="p">(</span><span class="n">rotated_x</span><span class="p">,</span> <span class="n">rotated_y</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span>
<span class="go">0.9547989732316251</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">max_x</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">],[</span><span class="n">y_intercept</span><span class="p">,</span> <span class="n">max_x</span> <span class="o">*</span> <span class="n">slope</span> <span class="o">+</span> <span class="n">y_intercept</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">[&lt;matplotlib.lines.Line2D object...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slope</span><span class="p">,</span> <span class="n">y_intercept</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">regress</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_x</span><span class="p">],[</span><span class="n">y_intercept</span><span class="p">,</span> <span class="n">max_x</span> <span class="o">*</span> <span class="n">slope</span> <span class="o">+</span> <span class="n">y_intercept</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">linewidth</span><span class="o">=</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.6&#39;</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">[&lt;matplotlib.lines.Line2D object...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;scatter_example.pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(If you want to plot the lines under the points, specify <code class="docutils literal"><span class="pre">zorder=n</span></code> to the plot commands, where <code class="docutils literal"><span class="pre">zorder</span></code> for the lines &lt; <code class="docutils literal"><span class="pre">zorder</span></code> for the points).</p>
</div>
<div class="section" id="histograms">
<h2>Histograms<a class="headerlink" href="#histograms" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">patches</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>add a &#8220;best fit&#8221; line</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.mlab</span> <span class="k">as</span> <span class="nn">mlab</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">normpdf</span><span class="p">(</span> <span class="n">bins</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;hist_example.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="heat-maps">
<h2>Heat Maps<a class="headerlink" href="#heat-maps" title="Permalink to this headline">¶</a></h2>
<p>Representing numbers as colors is a powerful data visualization technique.  This example does not actually use any functionality from PyCogent, it simply highlights a convenient <a class="reference external" href="http://matplotlib.sourceforge.net/">matplotlib</a> method for constructing a heat map.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">*</span> <span class="mf">0.01</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>The plot code</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">hot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="go">&lt;matplotlib.collections.QuadMesh object ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="go">&lt;matplotlib.colorbar.Colorbar object ...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;heatmap_example.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
<div class="news">
<table id="feed"><tr><td><h3><a href="http://pycogent.wordpress.com/">PyCogent News and Announcements</a></h3></td>
</tr></table></div>

    
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Quick installation using pip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">The Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_file_links.html">The data files used in the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Cogent Usage Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PyCogent Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_notes.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting_guidelines.html">Scripting guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licenses.html">Licenses and disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a></li>
</ul>



          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="using_likelihood_to_perform_evolutionary_analyses.html" title="Evolutionary analysis using likelihood"
              >previous</a> |
            <a href="multivariate_data_analysis.html" title="Multivariate data analysis"
              >next</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/cookbook/standard_statistical_analyses.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, PyCogent Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>