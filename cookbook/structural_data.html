<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Structural data &mdash; PyCogent 1.9 documentation</title>
    
    <link rel="stylesheet" href="../_static/agogo.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.9',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="PyCogent 1.9 documentation" href="../index.html" />
    <link rel="up" title="Manipulating biological data" href="manipulating_biological_data.html" />
    <link rel="next" title="Structural Data Advanced" href="structural_data_2.html" />
    <link rel="prev" title="Tabular data" href="tables.html" />     
<script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAbW_pA971hrPgosv-Msv7hRQZ4X-jPDmWcshBrz2j7-fJvuUABRTGWmdiw2G89JpgztGlFGG8hDxRAw"></script>\
<script type="text/javascript" src="../_static/google_feed.js"></script>

  </head>
  <body role="document">
    <div class="header-wrapper" role="banner">
      <div class="header">
        <div class="headertitle"><a
          href="../index.html">PyCogent 1.9 documentation</a></div>
        <div class="rel" role="navigation" aria-label="related navigation">
          <a href="tables.html" title="Tabular data"
             accesskey="P">previous</a> |
          <a href="structural_data_2.html" title="Structural Data Advanced"
             accesskey="N">next</a> |
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a>
        </div>
       </div>
    </div>

    <div class="content-wrapper">
      <div class="content">
        <div class="document">
            
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="structural-data">
<h1>Structural data<a class="headerlink" href="#structural-data" title="Permalink to this headline">¶</a></h1>
<p><em>Section author: Kristian Rother, Patrick Yannul</em></p>
<div class="section" id="protein-structures">
<h2>Protein structures<a class="headerlink" href="#protein-structures" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reading-protein-structures">
<h3>Reading Protein structures<a class="headerlink" href="#reading-protein-structures" title="Permalink to this headline">¶</a></h3>
<div class="section" id="retrieve-a-structure-from-pdb">
<h4>Retrieve a structure from PDB<a class="headerlink" href="#retrieve-a-structure-from-pdb" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.db.pdb</span> <span class="k">import</span> <span class="n">Pdb</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Pdb</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb_file</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;4tsv&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdb</span> <span class="o">=</span> <span class="n">pdb_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">pdb</span><span class="p">)</span>
<span class="go">134136</span>
</pre></div>
</div>
<p>This example will retrieve the structure as a PDB file string.</p>
</div>
<div class="section" id="parse-a-pdb-file">
<h4>Parse a PDB file<a class="headerlink" href="#parse-a-pdb-file" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.parse.pdb</span> <span class="k">import</span> <span class="n">PDBParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;data/4TSV.pdb&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span>
<span class="go">&lt;Structure id=4TSV&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="parse-a-pdb-entry-directly-from-the-web">
<h4>Parse a PDB entry directly from the web<a class="headerlink" href="#parse-a-pdb-entry-directly-from-the-web" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.parse.pdb</span> <span class="k">import</span> <span class="n">PDBParser</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span> <span class="o">=</span> <span class="n">PDBParser</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;4tsv&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="accessing-pdb-header-information">
<h4>Accessing PDB header information<a class="headerlink" href="#accessing-pdb-header-information" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span>
<span class="go">&#39;4TSV&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;resolution&#39;</span><span class="p">]</span>
<span class="go">&#39;1.80&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;r_free&#39;</span><span class="p">]</span>
<span class="go">&#39;0.262&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;space_group&#39;</span><span class="p">]</span>
<span class="go">&#39;H 3&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="navigating-structure-objects">
<h3>Navigating structure objects<a class="headerlink" href="#navigating-structure-objects" title="Permalink to this headline">¶</a></h3>
<div class="section" id="what-does-a-structure-object-contain">
<h4>What does a structure object contain?<a class="headerlink" href="#what-does-a-structure-object-contain" title="Permalink to this headline">¶</a></h4>
<p>A <code class="docutils literal"><span class="pre">cogent.parse.pdb.Structure</span></code> object as returned by <code class="docutils literal"><span class="pre">PDBParser</span></code> contains a tree-like hierarchy of <code class="docutils literal"><span class="pre">Entity</span></code> objects. They are organized such that <code class="docutils literal"><span class="pre">Structures</span></code> that contain <code class="docutils literal"><span class="pre">Models</span></code> that contain <code class="docutils literal"><span class="pre">Chains</span></code> that contain <code class="docutils literal"><span class="pre">Residues</span></code> that in turn contain <code class="docutils literal"><span class="pre">Atoms</span></code>. You can read more about the entity model on [URL of Marcins example page].</p>
</div>
<div class="section" id="how-to-access-a-model-from-a-structure">
<h4>How to access a model from a structure<a class="headerlink" href="#how-to-access-a-model-from-a-structure" title="Permalink to this headline">¶</a></h4>
<p>To get the first model out of a structure:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">struc</span><span class="p">[(</span><span class="mi">0</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span>
<span class="go">&lt;Model id=0&gt;</span>
</pre></div>
</div>
<p>The key contains the model number as a tuple.</p>
</div>
<div class="section" id="how-to-access-a-chain-from-a-model">
<h4>How to access a chain from a model?<a class="headerlink" href="#how-to-access-a-chain-from-a-model" title="Permalink to this headline">¶</a></h4>
<p>To get a particular chain:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span> <span class="o">=</span> <span class="n">model</span><span class="p">[(</span><span class="s1">&#39;A&#39;</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span>
<span class="go">&lt;Chain id=A&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-access-a-residue-from-a-chain">
<h4>How to access a residue from a chain?<a class="headerlink" href="#how-to-access-a-residue-from-a-chain" title="Permalink to this headline">¶</a></h4>
<p>To get a particular residue:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span> <span class="o">=</span> <span class="n">chain</span><span class="p">[(</span><span class="s1">&#39;ILE&#39;</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span>
<span class="go">&lt;Residue ILE resseq=154 icode= &gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="what-properties-does-a-residue-have">
<h4>What properties does a residue have?<a class="headerlink" href="#what-properties-does-a-residue-have" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span><span class="o">.</span><span class="n">res_id</span>
<span class="go">154</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;ILE&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span><span class="o">.</span><span class="n">h_flag</span>
<span class="go">&#39; &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span><span class="o">.</span><span class="n">seg_id</span>
<span class="go">&#39;    &#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="access-an-atom-from-a-residue">
<h4>Access an atom from a residue<a class="headerlink" href="#access-an-atom-from-a-residue" title="Permalink to this headline">¶</a></h4>
<p>To get a particular atom:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span> <span class="o">=</span> <span class="n">resi</span><span class="p">[(</span><span class="s2">&quot;N&quot;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span>
<span class="go">&lt;Atom (&#39;N&#39;, &#39; &#39;)&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="properties-of-an-atom">
<h4>Properties of an atom<a class="headerlink" href="#properties-of-an-atom" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39; N  &#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">element</span>
<span class="go">&#39; N&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">coords</span>
<span class="go">array([ 142.986,   36.523,    6.838])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">bfactor</span>
<span class="go">13.35</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom</span><span class="o">.</span><span class="n">occupancy</span>
<span class="go">1.0</span>
</pre></div>
</div>
</div>
<div class="section" id="if-a-model-chain-residue-atom-does-not-exist">
<h4>If a model/chain/residue/atom does not exist<a class="headerlink" href="#if-a-model-chain-residue-atom-does-not-exist" title="Permalink to this headline">¶</a></h4>
<p>You will get a <code class="docutils literal"><span class="pre">KeyError</span></code>.</p>
</div>
<div class="section" id="is-there-something-special-about-heteroatoms-to-consider">
<h4>Is there something special about heteroatoms to consider?<a class="headerlink" href="#is-there-something-special-about-heteroatoms-to-consider" title="Permalink to this headline">¶</a></h4>
<p>Yes, they have the <code class="docutils literal"><span class="pre">h_flag</span></code> attribute set in residues.</p>
</div>
<div class="section" id="how-are-altlocs-insertion-codes-represented">
<h4>How are Altlocs/insertion codes represented?<a class="headerlink" href="#how-are-altlocs-insertion-codes-represented" title="Permalink to this headline">¶</a></h4>
<p>Both are part of the residue/atom ID.</p>
</div>
</div>
<div class="section" id="useful-methods-to-access-structure-objects">
<h3>Useful methods to access Structure objects<a class="headerlink" href="#useful-methods-to-access-structure-objects" title="Permalink to this headline">¶</a></h3>
<div class="section" id="how-to-access-all-atoms-residues-etc-via-a-dictionary">
<h4>How to access all atoms, residues etc via a dictionary<a class="headerlink" href="#how-to-access-all-atoms-residues-etc-via-a-dictionary" title="Permalink to this headline">¶</a></h4>
<p>The <code class="docutils literal"><span class="pre">table</span></code> property of a structure returns a two-dimensional dictionary containing all atoms. The keys are 1) the entity level (any of &#8216;A&#8217;,&#8217;R&#8217;,&#8217;C&#8217;,&#8217;M&#8217;) and 2) the combined IDs of <code class="docutils literal"><span class="pre">Structure</span></code>, <code class="docutils literal"><span class="pre">Model</span></code>, <code class="docutils literal"><span class="pre">Chain</span></code>, <code class="docutils literal"><span class="pre">Residue</span></code>, <code class="docutils literal"><span class="pre">Atom</span></code> as a tuple.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">][(</span><span class="s1">&#39;4TSV&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;HIS&#39;</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">))]</span>
<span class="go">&lt;Atom (&#39;O&#39;, &#39; &#39;)&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-the-center-of-mass-of-a-model-or-chain">
<h4>Calculate the center of mass of a model or chain<a class="headerlink" href="#calculate-the-center-of-mass-of-a-model-or-chain" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">coords</span>
<span class="go">array([ 146.66615752,   35.08673503,   -3.60735847])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span><span class="o">.</span><span class="n">coords</span>
<span class="go">array([ 146.66615752,   35.08673503,   -3.60735847])</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-get-a-list-of-all-residues-in-a-chain">
<h4>How to get a list of all residues in a chain?<a class="headerlink" href="#how-to-get-a-list-of-all-residues-in-a-chain" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chain</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Residue ILE resseq=154 icode= &gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-get-a-list-of-all-atoms-in-a-chain">
<h4>How to get a list of all atoms in a chain?<a class="headerlink" href="#how-to-get-a-list-of-all-atoms-in-a-chain" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">resi</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;Atom (&#39;N&#39;, &#39; &#39;)&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="constructing-structures">
<h3>Constructing structures<a class="headerlink" href="#constructing-structures" title="Permalink to this headline">¶</a></h3>
<div class="section" id="how-to-create-a-new-entity">
<h4>How to create a new entity?<a class="headerlink" href="#how-to-create-a-new-entity" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">Structure</span></code>/<code class="docutils literal"><span class="pre">Model</span></code>/<code class="docutils literal"><span class="pre">Chain</span></code>/<code class="docutils literal"><span class="pre">Residue</span></code>/<code class="docutils literal"><span class="pre">Atom</span></code> objects can be created as follows:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.core.entity</span> <span class="k">import</span> <span class="n">Structure</span><span class="p">,</span><span class="n">Model</span><span class="p">,</span><span class="n">Chain</span><span class="p">,</span><span class="n">Residue</span><span class="p">,</span><span class="n">Atom</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;my_struc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">((</span><span class="mi">0</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">Chain</span><span class="p">((</span><span class="s1">&#39;A&#39;</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Residue</span><span class="p">((</span><span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,),</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Atom</span><span class="p">((</span><span class="s1">&#39;C  &#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,),</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">]),</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-add-entities-to-each-other">
<h4>How to add entities to each other?<a class="headerlink" href="#how-to-add-entities-to-each-other" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">addChild</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">setTable</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">table</span>
<span class="go">{&#39;A&#39;: {(&#39;my_struc&#39;, 0, &#39;A&#39;, (&#39;ALA&#39;, 1, &#39; &#39;), (&#39;C  &#39;, &#39; &#39;)): &lt;Atom (&#39;C  &#39;, &#39; &#39;)&gt;}, &#39;C&#39;: {(&#39;my_struc&#39;, 0, &#39;A&#39;): &lt;Chain id=A&gt;}, &#39;R&#39;: {(&#39;my_struc&#39;, 0, &#39;A&#39;, (&#39;ALA&#39;, 1, &#39; &#39;)): &lt;Residue ALA resseq=1 icode= &gt;}, &#39;M&#39;: {(&#39;my_struc&#39;, 0): &lt;Model id=0&gt;}}</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-remove-a-residue-from-a-chain">
<h4>How to remove a residue from a chain?<a class="headerlink" href="#how-to-remove-a-residue-from-a-chain" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="o">.</span><span class="n">delChild</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">table</span>
<span class="go">{&#39;A&#39;: {(&#39;my_struc&#39;, 0, &#39;A&#39;, (&#39;ALA&#39;, 1, &#39; &#39;), ...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="geometrical-analyses">
<h3>Geometrical analyses<a class="headerlink" href="#geometrical-analyses" title="Permalink to this headline">¶</a></h3>
<div class="section" id="calculating-euclidean-distances-between-atoms">
<h4>Calculating euclidean distances between atoms<a class="headerlink" href="#calculating-euclidean-distances-between-atoms" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.geometry</span> <span class="k">import</span> <span class="n">distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom1</span> <span class="o">=</span> <span class="n">resi</span><span class="p">[(</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom2</span> <span class="o">=</span> <span class="n">resi</span><span class="p">[(</span><span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span><span class="p">(</span><span class="n">atom1</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">atom2</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="go">1.4691967192993618</span>
</pre></div>
</div>
</div>
<div class="section" id="calculating-euclidean-distances-between-coordinates">
<h4>Calculating euclidean distances between coordinates<a class="headerlink" href="#calculating-euclidean-distances-between-coordinates" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.maths.geometry</span> <span class="k">import</span> <span class="n">distance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">distance</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">)</span>
<span class="go">6.324...</span>
</pre></div>
</div>
</div>
<div class="section" id="calculating-flat-angles-from-atoms">
<h4>Calculating flat angles from atoms<a class="headerlink" href="#calculating-flat-angles-from-atoms" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.struct.dihedral</span> <span class="k">import</span> <span class="n">angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom3</span> <span class="o">=</span> <span class="n">resi</span><span class="p">[(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a12</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">coords</span><span class="o">-</span><span class="n">atom1</span><span class="o">.</span><span class="n">coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a23</span> <span class="o">=</span> <span class="n">atom2</span><span class="o">.</span><span class="n">coords</span><span class="o">-</span><span class="n">atom3</span><span class="o">.</span><span class="n">coords</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span><span class="p">(</span><span class="n">a12</span><span class="p">,</span><span class="n">a23</span><span class="p">)</span>
<span class="go">1.856818...</span>
</pre></div>
</div>
<p>Calculates the angle in radians.</p>
</div>
<div class="section" id="calculating-flat-angles-from-coordinates">
<h4>Calculating flat angles from coordinates<a class="headerlink" href="#calculating-flat-angles-from-coordinates" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.struct.dihedral</span> <span class="k">import</span> <span class="n">angle</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a3</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a12</span> <span class="o">=</span> <span class="n">a2</span><span class="o">-</span><span class="n">a1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a23</span> <span class="o">=</span> <span class="n">a2</span><span class="o">-</span><span class="n">a3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">angle</span><span class="p">(</span><span class="n">a12</span><span class="p">,</span><span class="n">a23</span><span class="p">)</span>
<span class="go">1.5707963267948966</span>
</pre></div>
</div>
<p>Calculates the angle in radians.</p>
</div>
<div class="section" id="calculating-dihedral-angles-from-atoms">
<h4>Calculating dihedral angles from atoms<a class="headerlink" href="#calculating-dihedral-angles-from-atoms" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.struct.dihedral</span> <span class="k">import</span> <span class="n">dihedral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">atom4</span> <span class="o">=</span> <span class="n">resi</span><span class="p">[(</span><span class="s1">&#39;CG1&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">),]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dihedral</span><span class="p">(</span><span class="n">atom1</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span><span class="n">atom2</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span><span class="n">atom3</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">atom4</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
<span class="go">259.49277688244217</span>
</pre></div>
</div>
<p>Calculates the torsion in degrees.</p>
</div>
<div class="section" id="calculating-dihedral-angles-from-coordinates">
<h4>Calculating dihedral angles from coordinates<a class="headerlink" href="#calculating-dihedral-angles-from-coordinates" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">cogent.struct.dihedral</span> <span class="k">import</span> <span class="n">dihedral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a3</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a4</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dihedral</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span><span class="n">a2</span><span class="p">,</span><span class="n">a3</span><span class="p">,</span><span class="n">a4</span><span class="p">)</span>
<span class="go">90.0</span>
</pre></div>
</div>
<p>Calculates the torsion in degrees.</p>
</div>
</div>
<div class="section" id="other-stuff">
<h3>Other stuff<a class="headerlink" href="#other-stuff" title="Permalink to this headline">¶</a></h3>
<div class="section" id="how-to-count-the-atoms-in-a-structure">
<h4>How to count the atoms in a structure?<a class="headerlink" href="#how-to-count-the-atoms-in-a-structure" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">struc</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="go">1187</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-iterate-over-chains-in-canonical-pdb-order">
<h4>How to iterate over chains in canonical PDB order?<a class="headerlink" href="#how-to-iterate-over-chains-in-canonical-pdb-order" title="Permalink to this headline">¶</a></h4>
<p>In PDB, the chain with space as ID comes last, the
others in alphabetical order.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">sortedvalues</span><span class="p">():</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">chain</span>
<span class="go">&lt;Chain id=A&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-iterate-over-chains-in-alphabetical-order">
<h4>How to iterate over chains in alphabetical order?<a class="headerlink" href="#how-to-iterate-over-chains-in-alphabetical-order" title="Permalink to this headline">¶</a></h4>
<p>If you want the chains in purely alphabetical order:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="p">[</span><span class="n">model</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">]:</span>
<span class="gp">... </span>    <span class="nb">print</span> <span class="n">chain</span>
<span class="go">&lt;Chain id=A&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-iterate-over-all-residues-in-a-chain">
<h4>How to iterate over all residues in a chain?<a class="headerlink" href="#how-to-iterate-over-all-residues-in-a-chain" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">resi</span> <span class="k">for</span> <span class="n">resi</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>
<span class="go">218</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-remove-all-water-molecules-from-a-structure">
<h4>How to remove all water molecules from a structure<a class="headerlink" href="#how-to-remove-all-water-molecules-from-a-structure" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">struc</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;R&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;H_HOH&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">resi</span> <span class="ow">in</span> <span class="n">water</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">resi</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">delChild</span><span class="p">(</span><span class="n">resi</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">struc</span><span class="o">.</span><span class="n">setTable</span><span class="p">(</span><span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">struc</span><span class="o">.</span><span class="n">table</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="go">1117</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">resi</span> <span class="k">for</span> <span class="n">resi</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>
<span class="go">148</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
        </div>
        <div class="sidebar">
<div class="news">
<table id="feed"><tr><td><h3><a href="http://pycogent.wordpress.com/">PyCogent News and Announcements</a></h3></td>
</tr></table></div>

    
          <h3>Table Of Contents</h3>
          <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Quick installation using pip</a></li>
<li class="toctree-l1"><a class="reference internal" href="../README.html">The Readme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coding_guidelines.html">Coding guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_file_links.html">The data files used in the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Cogent Usage Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">PyCogent Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer_notes.html">For Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../scripting_guidelines.html">Scripting guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../licenses.html">Licenses and disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ChangeLog.html">Changelog</a></li>
</ul>



          <div role="search">
            <h3 style="margin-top: 1.5em;">Search</h3>
            <form class="search" action="../search.html" method="get">
                <input type="text" name="q" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
            </form>
          </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

    <div class="footer-wrapper">
      <div class="footer">
        <div class="left">
          <div role="navigation" aria-label="related navigaton">
            <a href="tables.html" title="Tabular data"
              >previous</a> |
            <a href="structural_data_2.html" title="Structural Data Advanced"
              >next</a> |
            <a href="../genindex.html" title="General Index"
              >index</a>
          </div>
          <div role="note" aria-label="source link">
              <br/>
              <a href="../_sources/cookbook/structural_data.txt"
                rel="nofollow">Show Source</a>
          </div>
        </div>

        <div class="right">
          
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, PyCogent Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
        </div>
        <div class="clearer"></div>
      </div>
    </div>

  </body>
</html>